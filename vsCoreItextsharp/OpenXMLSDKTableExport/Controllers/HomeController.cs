using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Mvc;
using OpenXMLSDKTableExport.Models;
using OpenXMLSDKTableExport.Services;

namespace OpenXMLSDKTableExport.Controllers
{
    public class HomeController : Controller
    {
        public IActionResult Index(string printData)
        {
            ViewData["TextToShow"] = string.IsNullOrEmpty(printData)?  "dummy text to show": printData;
            CreateFile.Word("./test.docx", ViewData["TextToShow"].ToString());
            CreateFile.Xlsx("./test.xlsx", ViewData["TextToShow"].ToString());
            CreateFile.Pdf("./test.pdf", ViewData["TextToShow"].ToString());
            CreateFile.HTMLToWord("./test.docx", @"<!DOCTYPE html ><html xmlns='http://www.w3.org/1999/xhtml'><head><meta charset='UTF-8' /><title></title><meta name='Generator' content='PowerTools for Open XML' /></head><body><div><div align='right'><table dir='ltr' class='pt-000000'><tr class='pt-000001'><td class='pt-000002'><p dir='ltr' class='pt-NoSpacing'><span xml:space='preserve' class='pt-000003'> </span></p></td><td class='pt-000004'><p dir='ltr' class='pt-Normal'><span xml:space='preserve' class='pt-000003'> </span></p></td><td class='pt-000005'><div align='left'><table dir='ltr' class='pt-000006'><tr class='pt-000007'><td class='pt-000008'><p dir='ltr' class='pt-NoSpacing'><span xml:space='preserve' class='pt-000003'> </span></p></td></tr><tr class='pt-000009'><td class='pt-000010'><p dir='ltr' class='pt-Title'><span class='pt-DefaultParagraphFont'>Business Trip Checklist</span></p></td></tr><tr class='pt-000011'><td class='pt-000012'><p dir='ltr' class='pt-NoSpacing'><span xml:space='preserve' class='pt-000003'> </span></p></td></tr></table></div><p dir='ltr' class='pt-Normal'><span xml:space='preserve' class='pt-000003'> </span></p></td></tr></table></div><div class='pt-000013'><h1 dir='ltr' class='pt-000014'><span class='pt-000015'>1.</span><span class='pt-DefaultParagraphFont-000016'>While You Are Away: Preparing the Office</span></h1></div><div align='left'><table dir='ltr' class='pt-000006'><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☒</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Organize any necessary meetings to take place on your trip; book appointments and meeting rooms.</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>If traveling internationally, obtain any necessary paperwork and vaccinations.</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Familiarize yourself with local business customs common at destination.</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Confirm appointments, schedules, reservations, etc.</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Tie up any loose ends at the office (finish up projects; set up out-of-office replies; notify or remind coworkers about your departure).</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Print out hard copies of presentations, agendas, and important documents.</span></p></td></tr></table></div><div class='pt-000013'><h1 dir='ltr' class='pt-000021'><span class='pt-000015'>2.</span><span class='pt-DefaultParagraphFont-000016'>While You Are Away: Preparing the Home</span></h1></div><div align='left'><table dir='ltr' class='pt-000006'><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Arrange for child, pet, and plant care; communicate needs and schedules.</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Pause routine deliveries.</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Make your home seem lived-in while away by putting lights and a radio on timers.</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Turn down thermostat.</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Leave house and car keys, and your complete itinerary, with a trusted friend.</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Lock windows, garages, and doors.</span></p></td></tr></table></div><div class='pt-000013'><h1 dir='ltr' class='pt-000021'><span class='pt-000015'>3.</span><span class='pt-DefaultParagraphFont-000016'>Packing for the Trip</span></h1></div><div align='left'><table dir='ltr' class='pt-000006'><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Make a list of the specific items of clothing you’ll need to pack for your trip to suit the various functions you’ll attend.</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Try to pack everything you need in a carry-on bag, to avoid the possibility of lost luggage.</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>If you check your bag, pack a second set of business clothes and toiletries in a carry-on bag, in case of lost luggage.</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Print several copies of this checklist, and save a copy on your computer’s hard drive to refer to when planning your next trip. Storing the checklist on your computer is the easiest way to make updates to it when necessary.</span></p></td></tr></table></div><div class='pt-000013'><h1 dir='ltr' class='pt-000021'><span class='pt-000015'>4.</span><span class='pt-DefaultParagraphFont-000016'>What to Leave for Family and Caregivers at Home</span></h1></div><div align='left'><table dir='ltr' class='pt-000006'><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Leave your contact information—including the names, addresses, and phone numbers of the hotels where you are staying—with a family member, so they can reach you while you’re away.</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Phone numbers (all contact numbers for you; doctor/vet; pharmacy; mechanic; school/daycare; helpful friends/neighbors; alarm company).</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Cash for groceries and emergencies.</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Consent for medical treatment forms and insurance cards.</span></p></td></tr><tr><td class='pt-000017'><p dir='ltr' class='pt-Checkbox'><span class='pt-DefaultParagraphFont-000018'>☐</span></p></td><td class='pt-000019'><p dir='ltr' class='pt-List'><span class='pt-DefaultParagraphFont-000020'>Your travel itinerary.</span></p></td></tr></table></div><p dir='ltr' class='pt-Normal'><span xml:space='preserve' class='pt-000003'> </span></p></div></body></html>");
            return View();
        }


        public IActionResult Word()
        {
            byte[] fileBytes = System.IO.File.ReadAllBytes("./test.doc");
            return File(fileBytes, "application/x-msdownload", "test.doc");
        }

        public IActionResult Xlsx()
        {
            byte[] fileBytes = System.IO.File.ReadAllBytes("./test.xlsx");
            return File(fileBytes, "application/x-msdownload", "test.xlsx");
        }

        public IActionResult Pdf()
        {
            byte[] fileBytes = System.IO.File.ReadAllBytes("./test.pdf");
            return File(fileBytes, "application/x-msdownload", "test.pdf");
        }
        public IActionResult Error()
        {
            return View(new ErrorViewModel { RequestId = Activity.Current?.Id ?? HttpContext.TraceIdentifier });
        }
    }
}
